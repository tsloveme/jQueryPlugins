(function(e){e.fn.pop_container=function(t){function c(n){var r=document.documentElement.clientWidth,s=document.documentElement.clientHeight,o=e(n).height(),u=e(n).width();e(n).css({top:(s-o)/2+e(document).scrollTop(),left:(r-u)/2});var a="#pop_back";i&&(a+=",#pop_back_ie6"),e(a).css({height:e(document).height()/1,width:e(document).width()/1}).fadeTo(600,t.bgOpacity)}function p(){e("#pop_container,#pop_back,#pop_back_ie6").fadeOut(600,function(){e("body").append(u),u.hide(),e("#pop_container,#pop_back,#pop_back_ie6").replaceWith("")})}function y(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+document.body.scrollLeft-document.body.clientLeft,y:e.clientY+document.body.scrollTop-document.body.clientTop}}function b(n){m=!0,e(this).get(0).setCapture&&e(this).get(0).setCapture(),g.initDiffX=y(n).x-d.position().left,g.initDiffY=y(n).y-d.position().top,g.sTop=i||!t.scrollWith?0:document.documentElement.scrollTop||document.body.scrollTop,e("body").bind("mousemove",w).css("cursor","move")}function w(e){m&&(g.moveX=y(e).x-g.initDiffX,g.moveY=y(e).y-g.initDiffY-g.sTop,d.css({left:g.moveX,top:g.moveY}))}function E(){e("body").unbind("mousemove",w).css("cursor","default"),v.get(0).releaseCapture&&v.get(0).releaseCapture()}var n={btnClose:"",toggle:!0,scrollWith:!0,bdColor:"#000",bdOpacity:.4,hasBg:!0,bgColor:"#000",bgOpacity:.4,zIndex:9997,dragble:!0,dragHandle:""},r=e.browser.msie&&e.browser.version<="8.0",i=e.browser.msie&&e.browser.version=="6.0"&&!e.support.style,t=e.extend(n,t),s=t.zIndex,o="<div id='pop_container' style='position:absolute;z-index:"+(s+2)+";opacity:0;filter:alpha(opacity=0)'><div id='pop_relative'style='position:relative;z-index:"+(s+3)+"'><div id='pop_transparent' style='border-radius:3px; box-shadow:0 0 18px #000;background-color:"+t.bdColor+";opacity:"+t.bdOpacity+";filter:alpha(opacity="+t.bdOpacity*100+");left:0;top:0;z-index:"+(s+2)+"'></div></div></div>";t.hasBg&&(o+="<div id='pop_back' style='display:none;position:absolute; top: 0px; left: 0px; z-index:"+(s+1)+"; background-color:"+t.bgColor+"; opacity:"+t.bgOpacity+"; filter:alpha(opacity="+t.bgOpacity*100+")'></div>"),e("body").append(o),t.toggle&&e("#pop_container").append("<span onmouseover=\"this.style.borderColor='#999';this.style.color='black'\"  onmouseout=\"this.style.borderColor='#c9c9c9';this.style.color='#666'\"  id=\"pop_close\" style=\"width:15px; height:15px; border:1px #c9c9c9 solid; line-height:15px; color:#666; cursor:pointer; position:absolute; right:6px; top:6px; text-decoration:none; display:block; text-align:center; z-index:"+(s+4)+';font:bold 12px/15px \'宋体\';" title="关闭">&times;</span>'),i&&e("body").append("<iframe id='pop_back_ie6' style='filter:alpha(opacity=1);background-color:#fff;position:absolute; z-index:"+s+";left:0; top:0; border:0;filter:alpha(opacity=1);'></iframe>");var u=e(this);u.attr("style",(u.attr("style")?u.attr("style")+";":"")+"position:absolute; left:5px; top:5px; z-index:"+(s+1)+"; background-color:white;").show(),e("#pop_relative").append(e(this)),e("#pop_container").css("margin-top","-50px"),e("#pop_container").animate({marginTop:0,opacity:1},600),r&&u.animate({opacity:0},1,function(){u.animate({opacity:1},500)});var a=t.btnClose;t.toggle&&(a+=",#pop_close"),e(a).live("click",function(){p()});var f=e(this).outerWidth()+10,l=e(this).outerHeight()+10;e("#pop_container,#pop_transparent").css({width:f,height:l}),c("#pop_container");if(t.scrollWith)if(i)e(window).scroll(function(){c("#pop_container")});else{var h=e("#pop_container").position().top-(document.documentElement.scrollTop||document.body.scrollTop);e("#pop_container").css({position:"fixed",top:h+"px"})}var d=e("#pop_container"),v=t.dragHandle?e(t.dragHandle):e("#pop_transparent"),m=!1,g={initDiffX:"",initDiffY:"",moveX:"",moveY:""};t.dragble&&(v.live({mousedown:b,mouseup:E}),t.dragHandle==""&&v.css("cursor","move"),oStyle=e("body").attr("style")||";",oStyle.indexOf("overflow-x:hidden")==-1&&e("body").attr("style",e("body").attr("style")+";overflow-x:hidden"),oStyle.indexOf("position:relative")==-1&&e("body").attr("style",e("body").attr("style")+";*position:relative"))},e.fn.kill_container=function(){e(this).appendTo("body").hide(),e("#pop_container,#pop_back,pop_back_ie6").remove()}})(jQuery)